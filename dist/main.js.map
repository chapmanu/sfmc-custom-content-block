{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/blocksdk/blocksdk.js","webpack:///./src/components/image-card.js","webpack:///./src/lib/api.js","webpack:///./src/components/image-selector.js","webpack:///./src/components/templating-block-fieldset.js","webpack:///./src/components/templating-block-app.js","webpack:///./src/lib/templating-block-utils.js","webpack:///./src/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","SDK","config","whitelistOverride","sslOverride","Array","isArray","undefined","onEditClose","this","handlers","_whitelistOverride","_sslOverride","_messageId","_messages","0","_readyToPost","_pendingMessages","_receiveMessage","window","addEventListener","parent","postMessage","method","origin","location","payload","execute","options","data","callback","success","_post","push","getCentralData","cb","getContent","getData","getUserData","getView","setBlockEditorWidth","setCentralData","dataObj","setContent","content","setData","setSuperContent","triggerAuth","appID","userData","stack","indexOf","substring","iframe","document","createElement","src","style","width","height","position","top","left","visibility","className","body","appendChild","triggerAuth2","authInfo","scope","state","join","authURL","endsWith","clientId","encodeURIComponent","redirectURL","_executePendingMessages","self","forEach","thisMessage","id","_parentOrigin","message","_validateOrigin","allowedDomains","length","optionalSsl","mcSubdomain","RegExp","test","sfdc","BlockSDK","template","innerHTML","ImageCard","HTMLElement","cloneNode","getElementsByClassName","innerText","getAttribute","getElementsByTagName","dispatchEvent","CustomEvent","detail","bubbles","customElements","define","async","post","url","console","log","response","fetch","JSON","stringify","json","getImages","images","query","simpleOperator","getImagesCached","super","_toggleSelector","grid","e","items","map","_getImageHTML","image","fileProperties","publishedURL","display","TemplatingBlockFieldSet","val","firstElementChild","getFieldHtml","_fields","stopPropagation","fields","field","idx","querySelector","title","type","TemplatingBlockApp","fieldSet","locked","selector","assetId","newSelector","placeholderRegex","parseTemplate","match","exec","getHtml","isFallback","replace","placeholder","replaceVal","sdk","setEverything","getOverrideData","getBlock","app","blockData","newBlockData","getElementById","initializeApp"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","/*\n * Copyright (c) 2018, salesforce.com, inc.\n * All rights reserved.\n * Licensed under the BSD 3-Clause license.\n * For full license text, see LICENSE.txt file in the repo root  or https://opensource.org/licenses/BSD-3-Clause\n */\n\nvar SDK = function (config, whitelistOverride, sslOverride) {\n\t// config has been added as the primary parameter\n\t// If it is provided ensure that the other paramaters are correctly assigned\n\t// for backwards compatibility\n\tif (Array.isArray(config)) {\n\t\twhitelistOverride = config;\n\t\tsslOverride = whitelistOverride;\n\t\tconfig = undefined;\n\t}\n\n\tif (config && config.onEditClose) {\n\t\tthis.handlers = {\n\t\t\tonEditClose: config.onEditClose\n\t\t};\n\t\tconfig.onEditClose = true;\n\t}\n\n\tthis._whitelistOverride = whitelistOverride;\n\tthis._sslOverride = sslOverride;\n\tthis._messageId = 1;\n\tthis._messages = {\n\t\t0: function () {}\n\t};\n\tthis._readyToPost = false;\n\tthis._pendingMessages = [];\n\tthis._receiveMessage = this._receiveMessage.bind(this);\n\n\twindow.addEventListener('message', this._receiveMessage, false);\n\n\twindow.parent.postMessage({\n\t\tmethod: 'handShake',\n\t\torigin: window.location.origin,\n\t\tpayload: config\n\t}, '*');\n};\n\nSDK.prototype.execute = function execute (method, options) {\n\toptions = options || {};\n\n\tvar self = this;\n\tvar payload = options.data;\n\tvar callback = options.success;\n\n\tif (!this._readyToPost) {\n\t\tthis._pendingMessages.push({\n\t\t\tmethod: method,\n\t\t\tpayload: payload,\n\t\t\tcallback: callback\n\t\t});\n\t} else {\n\t\tthis._post({\n\t\t\tmethod: method,\n\t\t\tpayload: payload\n\t\t}, callback);\n\t}\n};\n\nSDK.prototype.getCentralData = function (cb) {\n\tthis.execute('getCentralData', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.getContent = function (cb) {\n\tthis.execute('getContent', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.getData = function (cb) {\n\tthis.execute('getData', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.getUserData = function (cb) {\n\tthis.execute('getUserData', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.getView = function (cb) {\n\tthis.execute('getView', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.setBlockEditorWidth = function (value, cb) {\n\tthis.execute('setBlockEditorWidth', {\n\t\tdata: value,\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.setCentralData = function (dataObj, cb) {\n\tthis.execute('setCentralData', {\n\t\tdata: dataObj,\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.setContent = function (content, cb) {\n\tthis.execute('setContent', {\n\t\tdata: content,\n\t\tsuccess: cb});\n};\n\nSDK.prototype.setData = function (dataObj, cb) {\n\tthis.execute('setData', {\n\t\tdata: dataObj,\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.setSuperContent = function (content, cb) {\n\tthis.execute('setSuperContent', {\n\t\tdata: content,\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.triggerAuth = function (appID) {\n\tthis.getUserData(function (userData) {\n\t\tvar stack = userData.stack;\n\t\tif (stack.indexOf('qa') === 0) {\n\t\t\tstack = stack.substring(3,5) + '.' + stack.substring(0,3);\n\t\t}\n\t\tvar iframe = document.createElement('IFRAME');\n\t\tiframe.src = 'https://mc.' + stack + '.exacttarget.com/cloud/tools/SSO.aspx?appId=' + appID + '&restToken=1&hub=1';\n\t\tiframe.style.width= '1px';\n\t\tiframe.style.height = '1px';\n\t\tiframe.style.position = 'absolute';\n\t\tiframe.style.top = '0';\n\t\tiframe.style.left = '0';\n\t\tiframe.style.visibility = 'hidden';\n\t\tiframe.className = 'authframe';\n\t\tdocument.body.appendChild(iframe);\n\t});\n};\n\nSDK.prototype.triggerAuth2 = function (authInfo) {\n\tvar iframe = document.createElement('IFRAME');\n\tvar scope = '';\n\tvar state = '';\n\tif(Array.isArray(authInfo.scope)) {\n\t\tscope = '&scope=' + authInfo.scope.join('%20');\n\t}\n\tif(authInfo.state) {\n\t\tstate = '&state=' + authInfo.state;\n\t}\n\tiframe.src = authInfo.authURL + (authInfo.authURL.endsWith('/') ? '':'/') + 'v2/authorize?response_type=code&client_id=' + authInfo.clientId + '&redirect_uri=' + encodeURIComponent(authInfo.redirectURL) + scope + state;\n\tiframe.style.width= '1px';\n\tiframe.style.height = '1px';\n\tiframe.style.position = 'absolute';\n\tiframe.style.top = '0';\n\tiframe.style.left = '0';\n\tiframe.style.visibility = 'hidden';\n\tiframe.className = 'authframe';\n\tdocument.body.appendChild(iframe);\n};\n\n/* Internal Methods */\n\nSDK.prototype._executePendingMessages = function _executePendingMessages () {\n\tvar self = this;\n\n\tthis._pendingMessages.forEach(function (thisMessage) {\n\t\tself.execute(thisMessage.method, {\n\t\t\tdata: thisMessage.payload,\n\t\t\tsuccess: thisMessage.callback\n\t\t});\n\t});\n\n\tthis._pendingMessages = [];\n};\n\nSDK.prototype._post = function _post (payload, callback) {\n\tthis._messages[this._messageId] = callback;\n\tpayload.id = this._messageId;\n\tthis._messageId += 1;\n\t// the actual postMessage always uses the validated origin\n\twindow.parent.postMessage(payload, this._parentOrigin);\n};\n\nSDK.prototype._receiveMessage = function _receiveMessage (message) {\n\tmessage = message || {};\n\tvar data = message.data || {};\n\n\tif (data.method === 'handShake') {\n\t\tif (this._validateOrigin(data.origin)) {\n\t\t\tthis._parentOrigin = data.origin;\n\t\t\tthis._readyToPost = true;\n\t\t\tthis._executePendingMessages();\n\t\t\treturn;\n\t\t}\n\t} else if (data.method === 'closeBlock') {\n\t\tif (this._validateOrigin(data.origin)) {\n\t\t\t// here execute the method before closing the  block editing\n\t\t\t//onEditClose();\n\t\t\tif (this.handlers && this.handlers.onEditClose) {\n\t\t\t\tthis.handlers.onEditClose();\n\t\t\t}\n\t\t\tthis.execute('blockReadyToClose');\n\t\t\treturn;\n\t\t}\n\t}\n\n\t// if the message is not from the validated origin it gets ignored\n\tif (!this._parentOrigin || this._parentOrigin !== message.origin) {\n\t\treturn;\n\t}\n\t// when the message has been received, we execute its callback\n\t(this._messages[data.id || 0] || function () {})(data.payload);\n\tdelete this._messages[data.id];\n};\n\n// the custom block should verify it is being called from the marketing cloud\nSDK.prototype._validateOrigin = function _validateOrigin (origin) {\n\t// Make sure to escape periods since these strings are used in a regular expression\n\tvar allowedDomains = this._whitelistOverride || ['exacttarget\\\\.com', 'marketingcloudapps\\\\.com', 'blocktester\\\\.herokuapp\\\\.com'];\n\n\tfor (var i = 0; i < allowedDomains.length; i++) {\n\t\t// Makes the s optional in https\n\t\tvar optionalSsl = this._sslOverride ? '?' : '';\n\t\tvar mcSubdomain = allowedDomains[i] === 'exacttarget\\\\.com' ? 'mc\\\\.' : '';\n\t\tvar whitelistRegex = new RegExp('^https' + optionalSsl + '://' + mcSubdomain + '([a-zA-Z0-9-]+\\\\.)*' + allowedDomains[i] + '(:[0-9]+)?$', 'i');\n\n\t\tif (whitelistRegex.test(origin)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\nif (typeof(window) === 'object') {\n\twindow.sfdc = window.sfdc || {};\n\twindow.sfdc.BlockSDK = SDK;\n}\nif (typeof(module) === 'object') {\n\tmodule.exports = SDK;\n}\n","let template = document.createElement('template');\ntemplate.innerHTML = `\n<article class=\"slds-box slds-box\" style=\"cursor: pointer; height: 100%;\">\n\t<span class=\"name\" style=\"word-break: break-all;\"></span>\n\t<div class=\"slds-card__body slds-card__body_inner\">\n\t\t<img />\n\t</div>\n</article>\n`;\n\nclass ImageCard extends HTMLElement {\n\tconnectedCallback() {\n\t\tthis.appendChild(template.content.cloneNode(true));\n\n\t\tthis.getElementsByClassName('name')[0].innerText = this.getAttribute('name');\n\t\tthis.getElementsByTagName('img')[0].src = this.getAttribute('url');\n\n\t\tthis.addEventListener('click', () => {\n\t\t\tthis.dispatchEvent(new CustomEvent('change', {\n\t\t\t\tdetail: {\n\t\t\t\t\tvalue: this.getAttribute('url')\n\t\t\t\t},\n\t\t\t\tbubbles: true\n\t\t\t}));\n\t\t});\n\t}\n}\n\ncustomElements.define('image-card', ImageCard);\n","async function post (url, data) {\n\tconsole.log(\"IM THE URL\", url);\n\tconst response = await fetch('/proxy/' + url, {\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(data),\n\t});\n\treturn await response.json();\n}\n\nasync function get(url, data) {\n\tconsole.log(\"IM THE URL\", url);\n\tconst response = await fetch('/proxy/' + url, {\n\t\tmethod: 'GET',\n\t});\n\treturn await response.json();\n}\n\nexport async function getBlock(id) {\n\tconst response = await fetch(`/proxy/asset/v1/content/assets/${id}`);\n\treturn await response.json();\n}\n\nexport async function getCustomTemplates() {\n\treturn await post('asset/v1/content/assets/query', {\n\t\tquery: {\n\t\t\tproperty: 'tags',\n\t\t\tsimpleOperator: 'where',\n\t\t\tvalue: 'customblock-template'\n\t\t}\n\t});\n}\n\nfunction getImagesCached() {\n\tlet images;\n\treturn async () => {\n\t\tif (!images) {\n\t\t\timages = await post('/asset/v1/content/assets/query', {\n\t\t\t\tquery: {\n\t\t\t\t\tproperty: 'fileProperties.extension',\n\t\t\t\t\tsimpleOperator: 'in',\n\t\t\t\t\tvalue: [\"tif\", \"tiff\", \"bmp\",\"jpg\", \"jpeg\", \"gif\", \"png\"]\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tdebugger \n\t\tconsole.log(images);\n\t\treturn images;\n\t}\n}\n\nexport const getImages = getImagesCached();\n","import { getImages } from '../lib/api';\nimport './image-card';\n\nconst template = document.createElement('template');\ntemplate.innerHTML = `\n<button class=\"slds-button slds-button_neutral\">Select</button>\n<div class=\"slds-grid slds-gutters slds-wrap slds-grid_vertical-stretch\" style=\"display: none;\"></div>\n`;\n\nclass ImageSelector extends HTMLElement {\n\tconstructor () {\n\t\tsuper();\n\n\t\tthis._toggleSelector = this._toggleSelector.bind(this);\n\t}\n\n\tasync connectedCallback() {\n\t\tthis.appendChild(template.content.cloneNode(true));\n\t\tthis.grid = this.getElementsByClassName('slds-grid')[0];\n\n\t\tthis.getElementsByTagName('button')[0].addEventListener('click', this._toggleSelector);\n\n\t\tthis.addEventListener('change', e => {\n\t\t\tthis.value = e.detail.value;\n\t\t\tthis._toggleSelector();\n\t\t});\n\n\t\tconst images = await getImages();\n\t\tthis.grid.innerHTML = images.items.map(this._getImageHTML).join('');\n\t}\n\n\t_getImageHTML(image) {\n\t\treturn `\n\t\t\t<div class=\"slds-col slds-size_1-of-2 slds-p-top_x-small\">\n\t\t\t\t<image-card id=\"${image.id}\" name=\"${image.name}\" url=\"${image.fileProperties.publishedURL}\"></image-card>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t_toggleSelector() {\n\t\tthis.grid.style.display = this.grid.style.display === 'none' ? 'flex' : 'none';\n\t}\n}\n\ncustomElements.define('image-selector', ImageSelector);\n","import './image-selector';\n\nconst template = document.createElement('template');\ntemplate.innerHTML = `\n<div class=\"slds-box\">\n</div>\n`;\n\nclass TemplatingBlockFieldSet extends HTMLElement {\n\tset fields(val) {\n\t\tif (val) {\n\t\t\tthis.firstElementChild.innerHTML = val.map(this.getFieldHtml).join('');\n\t\t\tthis._fields = val;\n\t\t}\n\t}\n\n\tasync connectedCallback() {\n\n\t\tthis.appendChild(template.content.cloneNode(true));\n    \n\t\tthis.firstElementChild.addEventListener('change', e => {\n\t\t\te.stopPropagation();\n\t\t\tthis.dispatchEvent(new CustomEvent('change', {\n\t\t\t\tdetail: {\n\t\t\t\t\tfields: this._fields.map(\n\t\t\t\t\t\t(field, idx) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...field,\n\t\t\t\t\t\t\t\tvalue: this.querySelector(`#template-field-${idx}`).value\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tbubbles: false\n\t\t\t}));\n\t\t});\n\t}\n\n\tgetFieldHtml(field, idx) {\n\t\treturn `\n<div class=\"slds-form-element\">\n\t<label class=\"slds-form-element__label\" for=\"template-field-${idx}\">${field.title}</label>\n\t<div class=\"slds-form-element__control\">\n\t\t${field.type === 'image' ?\n\t\t\t'<image-selector ' :\n\t\t\t'<input type=\"text\" class=\"slds-input\" '\n\t\t} id=\"template-field-${idx}\" value=\"${field.value || ''}\" />\n\t</div>\n</div>\n`;\n\t}\n}\n\ncustomElements.define('templating-block-fieldset', TemplatingBlockFieldSet);\n","import './templating-block-fieldset';\n// import './imageSelector'\n\nclass TemplatingBlockApp extends HTMLElement {\n\tset fields(val) {\n\t\tthis.fieldSet.fields = val;\n\t}\n\n\tconnectedCallback() {\n\t\tconst dispatchEvent = type => e => {\n\t\t\treturn this.dispatchEvent(new CustomEvent('change', {\n\t\t\t\tdetail: {\n\t\t\t\t\t...e.detail,\n\t\t\t\t\ttype: type\n\t\t\t\t},\n\t\t\t\tbubbles: false\n\t\t\t}));\n\t\t}\n\n\n\t\t// not using shadow DOM to avoid loading SLDS styles _everywhere_\n\t\tif (!this.locked) {\n\t\t\tconst selector = document.createElement('templating-block-selector');\n\t\t\tselector.assetId = this.assetId;\n\t\t\tthis.appendChild(selector);\n\t\t\tselector.addEventListener('change', dispatchEvent('template'));\n    }\n    \n    const newSelector = document.createElement('image-selector');\n    this.appendChild(newSelector);\n\n\t\tthis.fieldSet = document.createElement('templating-block-fieldset');\n\t\tthis.appendChild(this.fieldSet);\n\n\t\tthis.fieldSet.addEventListener('change', dispatchEvent('fields'));\n\t}\n}\n\ncustomElements.define('templating-block-app', TemplatingBlockApp);\n","const placeholderRegex = /\\[\\[(\\w+)\\|([^|]+)\\|([^\\]]*)\\]\\]/g;\n\nexport function parseTemplate (template) {\n\tconst fields = [];\n\tlet match;\n\n\twhile (match = placeholderRegex.exec(template.content)) {\n\t\tfields.push({\n\t\t\ttype: match[1],\n\t\t\ttitle: match[2]\n\t\t});\n\t}\n\n\treturn fields;\n}\n\nexport function getHtml(template, fields = [], isFallback) {\n\tlet idx = 0;\n\treturn template.content.replace(placeholderRegex,\n\t\t(match, type, title, placeholder) => {\n\t\t\tlet replaceVal = '';\n\t\t\tif (fields[idx] && fields[idx].value) {\n\t\t\t\treplaceVal = fields[idx].value;\n\t\t\t} else if (isFallback) {\n\t\t\t\treplaceVal = placeholder;\n\t\t\t}\n\t\t\tidx++;\n\t\t\treturn replaceVal;\n\t\t}\n\t);\n}\n","import './components/templating-block-app';\n// import './components/imageSelector';\nimport SDK from 'blocksdk';\nimport { getHtml, parseTemplate } from './lib/templating-block-utils';\nimport { getBlock } from './lib/api';\n\n// SSL OVERRIDE IS SET TO TRUE MEANING USE FOR LOCAL DEV\n// TODO: SET TO FALSE FOR PRODUCTION?\nconst sdk = new SDK(null, null, true);\n\nfunction initializeApp(data) {\n\tconst app = document.createElement('templating-block-app');\n\tapp.locked = data.locked;\n\tif (data.template) {\n\t\tapp.assetId = data.template.id;\n\t}\n\tdebugger\n\n\t// respond to app changes\n\tapp.addEventListener('change', e => {\n\t\t// always get current data\n\t\tsdk.getData(blockData => {\n\t\t\tconst newBlockData = blockData;\n\n\t\t\t// extend current data with new data\n\t\t\tswitch (e.detail.type) {\n\t\t\t\tcase 'template':\n\t\t\t\t\tnewBlockData.template = e.detail.template;\n\t\t\t\t\tnewBlockData.fields = parseTemplate(newBlockData.template);\n\t\t\t\t\tapp.fields = newBlockData.fields;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'fields':\n\t\t\t\t\tnewBlockData.fields = e.detail.fields;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tsetEverything(newBlockData);\n\t\t});\n\t});\n\n\tdocument.getElementById('workspace').appendChild(app);\n\tapp.fields = data.fields;\n}\n\nfunction setEverything(data) {\n\t// always set data with latest\n\tsdk.setData(data);\n\t// set content with latest changes\n\tsdk.setContent(getHtml(data.template, data.fields, false));\n\t// update preview to use latest, with placeholders for preview\n\tsdk.setSuperContent(getHtml(data.template, data.fields, true));\n}\n\nasync function getOverrideData(data, assetId) {\n\tdata.template = await getBlock(assetId);\n\tdata.fields = parseTemplate(data.template).map((field, idx) => {\n\t\treturn {\n\t\t\t...field,\n\t\t\tvalue: data.fields && data.fields[idx] && data.fields[idx].value || ''\n\t\t};\n\t});\n\tdata.locked = true;\n\n\treturn data;\n}\n\nsdk.getData(async (data) => {\n\tdebugger\n\tif (window.app.assetId) {\n\t\tconst overrideData = await getOverrideData(data, window.app.assetId);\n\t\tsetEverything(overrideData);\n\t}\n\t\n\tinitializeApp(data);\n});\n\nsdk.triggerAuth(window.app.appID);\n"],"sourceRoot":""}